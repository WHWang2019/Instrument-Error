# Instrument-Error
## 二维高斯模拟

#### 计算程序:
(1)生成 xy 方向上的二维高斯函数作为 PSF 信号序列,满足 N(0,0,1,1)。
(2)读取 450nm_shift.mat 中的一个像素内响应数据,按 1%的随机变化扩展,经过一定的处理和归一化处理,平均响应在 0.87。
(3)生成一组近似满足 N(0,sigma)的抖动序列,抖动在±10 个 pixel 以内进行。将抖动添加到 PSF 信号中。
(4)第 3 步中得到的信号矩阵乘以第 2 步中得到的像素不均匀性矩阵对应的部分,作为该时刻的 CCD 读数。
(5)在一定时间内的 CCD 读数进行积分(相加),即为总光子数(流量)。我们设每 0.1s抖动一次,单次曝光时间 3s,总观测时间 1h。
(6)目标星坐标为(0,0)。在 1/4 个 pixel 以内的位置随机选取 4 个参考星。
(7)将每组抖动的 4 个参考星的流量做平均,最终总观测时间内的目标星和参考星平均值计数进行归一化后计算标准差,即为抖动和像素不均匀性带来的影响。

#### 一些典型结果:
(1)抖动序列 sigma=1,读数在 $4×4$ 个 pixel 进行(覆盖 90.3%的能量),一次观测(1h,1200组抖动)的中心目标星 std = 0.0468(百分之五左右),参考星平均的 std = 0.0472,二者做差后的 std = 0.0076(千分之八左右)。
(2)抖动序列 sigma=1/2,读数在 $4×4$ 个 pixel 进行(覆盖 90.3%的能量),一次观测(1h,1200 组抖动)的中心目标星 std = 0.0116(百分之一左右),参考星平均的 std =0.0122,二者做差后的 std = 0.00369(千分之四左右)
(3)抖动序列 sigma=1,读数在 $8×8$ 个 pixel 进行(覆盖 99.4%的能量),一次观测(1h,1200组抖动)的中心目标星 std = 0.00453(千分之五左右),参考星平均的 std = 0.00476,二者做差后的 std = 0.000832(千分之一左右)。
(4)抖动序列 sigma=1/2,读数在 $8×8$ 个 pixel 进行(覆盖 99.4%的能量),一次观测(1h,1200组抖动)的中心目标星 std = 0.000189(万分之二左右),参考星平均的 std = 0.00476,二者做差后的 std = 0.000938(万分之一左右)。

#### 结论：
(1)像素内不均匀对结果影响较小,抖动对结果的影响较为显著。抖动序列 sigma 越小,读数范围越大,星的变化标准差越小。且随着读数范围的扩大,减小抖动对结果的影响更明显。在 sigma=1,8*8 的情况下单颗目标星的标准差达到千分之五左右。
(2)多颗参考星的选取可以有效地降低抖动的影响。在 sigma=1,8*8 的情况下,选取参考星可以使抖动导致目标星的变化降低到千分之一左右。
